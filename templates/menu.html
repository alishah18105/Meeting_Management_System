{% extends "MeetingDashboard.html" %} 
{% block title %}Dashboard - Meeting Management{% endblock %} 
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/menu.css') }}">
<h2 class="dashboard-title">Welcome to Meeting Management Dashboard</h2>
<hr>
<div class="cards-grid"> <!-- Example Card -->
  <div class="card">
    <!-- <div class="card-body"> <h5 class="card-title"><i class="bi bi-calendar-check me-2"></i>Meetings</h5> <ul class="stats-list"> <li>Scheduled Meetings: <span>20</span></li> <li>Last Month Meetings: <span>16</span></li> <li>Cancelled Meetings: <span>16</span></li> <li>Most Attended Meetings: <span>7</span></li> </ul> </div> -->
    <div class="card-body">
      <ul class="stats-list">
        <h5 class="card-title"><i class="bi bi-calendar-check me-2"></i>Meetings</h5>
        <li>Scheduled Meetings: <span>{{ scheduled_meetings }}</span></li>
        <li>Last Month Meetings: <span>{{ last_month_meetings }}</span></li>
        <li>Cancelled Meetings: <span>{{ cancelled_meetings }}</span></li>
        <li>Total Meetings: <span>{{ total_meetings }}</span></li>
      </ul>
    </div>
  </div>
  <!-- <div class="card"> <div class="card-body"> <h5 class="card-title"><i class="bi bi-door-open me-2"></i>Room Availability</h5> <ul class="stats-list"> <li>Available Rooms: <span>8</span></li> <li>Booked Rooms: <span>12</span></li> <li>Pending Requests: <span>3</span></li> <li>Utilization: <span>75%</span></li> </ul> </div> </div> -->
  <div class="card">
    <div class="card-body">
      <h5 class="card-title"> <i class="bi bi-door-open me-2"></i>Rooms</h5>
      <ul class="stats-list ">
        <li>Booked Rooms: <span>{{ booked_rooms }}</span></li>
        <li>Total Rooms: <span>{{ total_rooms }}</span></li>
        <li>Utilization: <span>{{ "%.1f"|format(utilization if utilization is defined else 0) }}%</span></li>
      </ul> {% if most_used_rooms %}
      <hr>
      <h6><i class="bi bi-bar-chart me-2"></i>Most Used Rooms</h6>
      <ul class="list-unstyled small"> {% for name, count in most_used_rooms %} <li><i
            class="bi bi-circle-fill text-secondary me-1"></i>{{ name }} — {{ count }} meetings</li> {% endfor %} </ul>
      {% endif %}
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      <h5 class="card-title"><i class="bi bi-journal-text me-2"></i>Reports</h5>
      <ul class="stats-list">
        <li>Total Reports Generated: <span>{{summarized_meetings }}</span></li>
        <li>Avg. Attendance Rate: <span>{{ "%.1f"|format(avg_attendance_rate) }}%</span></li>
        <li>Total Participants Joined: <span>{{ total_participants_joined }}</span></li>
        <li>Average Participants per Meeting: <span>{{ "%.1f"|format(avg_participants_per_meeting) }}</span></li>
      </ul>
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      <h5 class="card-title"><i class="bi bi-calendar-day me-2"></i>Calendar</h5>
      <!-- <ul class="stats-list"> <li>Upcoming Events: <span>14</span></li> <li>Holidays: <span>5</span></li> <li>Team Schedules: <span>8</span></li> <li>Reminders Set: <span>11</span></li> </ul> -->
      <ul class="stats-list">
        <li>Upcoming Events: <span>{{ upcoming_events }}</span></li>
        <li>Reminders Set: <span>{{ reminders }}</span></li>
        <li>Events This Week: <span>{{ events_this_week|length }}</span></li>
        <li>Next Meeting: <span>
            {% if next_meeting %}
            {{ next_meeting.start_time.strftime("%d-%m-%Y") }}
            {% else %}
            None
            {% endif %}
          </span></li>
      </ul>
    </div>
  </div> <!-- Add other cards here -->
</div>
<hr>
<div class="todo-section">
  <h3 class="section-title"><i class="bi bi-list-task me-2"></i>To-Do</h3>

  <div class="d-flex align-items-center justify-content-between mb-3" style="gap: 10px; flex-wrap: nowrap;">

    <!-- Add Form -->
    <form method="POST" action="{{ url_for('todo.add_todo') }}" class="d-flex align-items-center gap-2 mb-0 flex-grow-1"
      style="margin: 0;">
      <input type="text" name="task" class="form-control" placeholder="Enter a new task" required style="height: 42px;">
      <button type="submit" class="btn btn-primary d-flex align-items-center justify-content-center"
       >
        <i class="bi bi-plus-circle me-1"></i> Add
      </button>
    </form>

    <!-- Clear Button -->
    <form method="POST" action="{{ url_for('todo.clear_todos') }}" class="d-flex align-items-center mb-0"
      style="margin: 0;">
      <button type="submit" class="btn btn-danger d-flex align-items-center justify-content-center">
        <i class="bi bi-x-circle me-1"></i> Clear All
      </button>
    </form>

  </div>


  <!-- ✅ To-Do Table -->
  {% if todos %}
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>#</th>
        <th>Task</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for todo in todos %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ todo.title }}</td>
        <td>
          {% if todo.status == "completed" %}
          <span class="badge bg-success">Completed <i class="bi bi-check-lg"></i></span>
          {% else %}
          <span class="badge bg-warning text-dark">Pending <i class="bi bi-exclamation-triangle-fill"></i></span>
          {% endif %}
        </td>
        <td>
          {% if todo.status != "completed" %}
          <form method="POST" action="{{ url_for('todo.complete_todo', todo_id=todo.todo_id) }}"
            style="display:inline;">
            <button type="submit" class="btn btn-sm btn-success action-btn">Mark Done <i
                class="bi bi-check-lg"></i></button>
          </form>
          {% endif %}
          <form method="POST" action="{{ url_for('todo.delete_todo', todo_id=todo.todo_id) }}" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-outline-danger action-btn">Delete <i
                class="bi bi-trash-fill"></i></button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="text-muted">No tasks added yet.</p>
  {% endif %}
</div>
{% endblock %}